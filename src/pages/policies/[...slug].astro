---
// Import the `<StarlightPage>` component first to set up cascade layers.
import StarlightPage from '@astrojs/starlight/components/StarlightPage.astro'

// Import any other components you want to use in your custom page.
import AnchorHeading from '@astrojs/starlight/components/AnchorHeading.astro'

// Import collection
import { getCollection, render } from 'astro:content'

export async function getStaticPaths() {
  const policies = await getCollection('policies')
  return policies.map((policy) => ({
    params: { slug: policy.id },
    props: { policy },
  }))
}

const { policy } = Astro.props
const { Content } = await render(policy)
---

<StarlightPage
  frontmatter={{ title: 'Kyverno Policies' }}
  sidebar={[
    {
      label: 'Policies',
      collapsed: false,
      autogenerate: {
        directory: 'policies',
        collapsed: true,
        attrs: { style: 'text-transform: capitalize' },
      },
    },
  ]}
>
  <Content />
</StarlightPage>
